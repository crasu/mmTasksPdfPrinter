module.exports = {
  serializeTasks: function (tasks) {
    if(tasks && typeof tasks === 'object' && tasks.length) {
      var result = "";
      var i;
      for(i = 0; i < tasks.length; i++) {
        if(tasks[i].jiraTask && (tasks[i].statusCode || tasks[i].statusCode === 0) && tasks[i].user) {
          result += tasks[i].jiraTask + ";" + tasks[i].statusCode + ";" + tasks[i].user + "\n";
        }
      }
      return result;
    } else {
      return "";
    }
  },
  deserializeTasks: function (inputString) {
    if(inputString && typeof inputString === 'string') {
      var result = [],
          inputArray = inputString.split("\n");
      var i;
      for(i = 0; i < inputArray.length; i++) {
        if(inputArray[i] && inputArray[i] !== "") {
          var tmp = inputArray[i].split(";");
          if(tmp.length >= 3) {
            result.push({
              jiraTask: tmp[0],
              statusCode: tmp[1],
              user: tmp[2]
            });
          }
        }
      }
      return result;
    } else {
      return undefined;
    }
  }
};

/*equal module.exports.serializeTasks(), "", "Return an empty String if no Parameter is passed"*/
/*equal module.exports.serializeTasks([]), "", "Return an empty String if no Tasks are specified"*/
/*equal module.exports.serializeTasks("13;7;testuser\n654;0;testuser2\n"), "", "Return an empty String if the Tasks have the wrong format"*/
/*equal module.exports.serializeTasks([{jiraTask: "13", statusCode:"7", user: "testuser"}, {jiraTask: "654", statusCode: "0", user: "testuser2"}]), "13;7;testuser\n654;0;testuser2\n", "Tasks are serialized correctly"*/
/*equal module.exports.deserializeTasks(), undefined, "Return undefined if no Parameter is passed"*/
/*equal module.exports.deserializeTasks(""), undefined, "Return undefined if no parseString is specified"*/
/*test require('assert').deepEqual(module.exports.deserializeTasks("13;7;testuser\n654;0;testuser2\n"), [{jiraTask: "13", statusCode:"7", user: "testuser"}, {jiraTask: "654", statusCode: "0", user: "testuser2"}]), function () {return true;}, "Tasks are deserialized correctly"*/
/*equal module.exports.serializeTasks(module.exports.deserializeTasks("13;7;testuser\n654;0;testuser2\n")), "13;7;testuser\n654;0;testuser2\n", "Reserializing of deserialized Tasks should return the input"*/
/*test require('assert').deepEqual(module.exports.deserializeTasks(module.exports.serializeTasks([{jiraTask: "13", statusCode:"7", user: "testuser"}, {jiraTask: "654", statusCode: "0", user: "testuser2"}])), [{jiraTask: "13", statusCode:"7", user: "testuser"}, {jiraTask: "654", statusCode: "0", user: "testuser2"}]), function () {return true;}, "Deserializing of serialized Tasks should return the input"*/
